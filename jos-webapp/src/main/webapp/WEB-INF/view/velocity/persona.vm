#set($springXhtmlCompliant = true)
<html>
	<head>
		<title>#springMessage("openid") - #springMessage("persona.title.persona")</title>
		<link rel="stylesheet" type="text/css" media="all" href="#springUrl('/resources/jscalendar/skins/aqua/theme.css')" title="Aqua" />
		<script type="text/javascript" src="#springUrl('/resources/jscalendar/calendar_stripped.js')"></script>
		<script type="text/javascript" src="#springUrl('/resources/jscalendar/calendar-setup_stripped.js')"></script>
		<script type="text/javascript" src="#springUrl('/resources/jscalendar/lang/calendar-en.js')"></script>
		<script type="text/javascript" src="#springUrl('/resources/scripts/jquery-1.2.6.min.js')"></script>
		<script type="text/javascript" src="#springUrl('/resources/scripts/persona.js')"></script>
	</head>
	<body>
		<fieldset>
		<legend>#springMessage("persona.title.persona")</legend>
			<form action="#josUrl("/persona#if($token && $token != '')?token=$!token#end")" method="post">
				#springBindEscaped("persona.id" false)
				<input type="hidden" name="$!{status.expression}" value="$!{status.value}" />
				<table>
					<tr>
						<td class="label">
							<label for="name">#springMessage("persona.label.name")</label>
						</td>
						<td>
							#springFormInput("persona.name" "")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="nickname">#springMessage("persona.label.nickname")</label>
						</td>
						<td>
							#springFormInput("persona.nickname" "")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="email">#springMessage("persona.label.email")</lable>
						</td>
						<td>
							#springFormInput("persona.email" "")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="fullname">#springMessage("persona.label.fullname")</label>
						</td>
						<td>
							#springFormInput("persona.fullname" "")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="dob">#springMessage("persona.label.dob")</label>
						</td>
						<td>
							#springFormInput("persona.dob" "")
							<img src="#josUrl("/resources/jscalendar/img.gif")" id="f_trigger_c" style="border: 1px solid red; cursor: pointer;" title="Date selector" onmouseover="this.style.background='red';" onmouseout="this.style.background=''" />
<script type="text/javascript">
    Calendar.setup({
        inputField     :    "dob",     // id of the input field
        //ifFormat       :    "%B %e, %Y",      // format of the input field
        ifFormat       :    "%Y-%m-%d",
        button         :    "f_trigger_c",  // trigger for the calendar (button ID)
        align          :    "Tl",           // alignment (defaults to "Bl")
        singleClick    :    true
    });
</script>
							#springShowErrors("" "error")
						</td>
					</tr>
					#springBindEscaped("persona.gender" false)
					<tr>
						<td class="label">
							<label for="gender">#springMessage("persona.label.gender")</label>
						</td>
						<td>
							<input type="radio" id="gender_U" name="$!{status.expression}" value="U" #if("$!status.value" == "U")checked="checked"#end /><label for="gender_U">#springMessage("gender.unknown")</label>
							<input type="radio" id="gender_M" name="$!{status.expression}" value="M" #if("$!status.value" == "M")checked="checked"#end /><label for="gender_M">#springMessage("gender.male")</label>
							<input type="radio" id="gender_F" name="$!{status.expression}" value="F" #if("$!status.value" == "F")checked="checked"#end /><label for="gender_F">#springMessage("gender.female")</label>
							<input type="radio" id="gender_A" name="$!{status.expression}" value="A" #if("$!status.value" == "A")checked="checked"#end /><label for="gender_A">#springMessage("gender.artificialMale")</label>
							<input type="radio" id="gender_E" name="$!{status.expression}" value="E" #if("$!status.value" == "E")checked="checked"#end /><label for="gender_E">#springMessage("gender.artificialFemale")</label>
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="postcode">#springMessage("persona.label.postcode")</label>
						</td>
						<td>
							#springFormInput("persona.postcode" "")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="country">#springMessage("persona.label.country")</label>
						</td>
						<td>
							#josFormSingleSelect("persona.country" $relatedCountries $countries "id='country'")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="language">#springMessage("persona.label.language")</label>
						</td>
						<td>
							#josFormSingleSelect("persona.language" $relatedLanguages $languages "id='language'")
							#springShowErrors("" "error")
						</td>
					</tr>
					<tr>
						<td class="label">
							<label for="timezone">#springMessage("persona.label.timezone")</label>
						<td>
							#josFormSingleSelect("persona.timezone" $relatedTimeZones $timeZones "id='timezone'")
							#springShowErrors("" "error")
						</td>
					</tr>
				</table>
				#springBindEscaped("persona.attributes" false)
				#foreach($attribute in $status.value)
					<div class="attribute">
						<table>
							#set($id = $velocityCount)
							<tr>
								<td class="label">
									<input type="text" name="alias.${id}" value="$!attribute.alias" class="alias" />
									<input type="text" name="type.${id}" value="$!attribute.type" class="type" />
								</td>
								<td class="value">
									<ul>
										#foreach($value in $attribute.values)
											<li>
												<input type="text" id="attributes.$id" name="value.$id" value="$!value" class="value" />
												<a href="#" onclick="personaAddAttributeValue(this);return false;">
													<img src="#springUrl('/resources/images/plus.gif')" class="value" />
												</a>
												<a href="#" onclick="personaRemoveAttributeValue(this);return false;">
													<img src="#springUrl('/resources/images/minus.gif')" class="value" />
												</a>
											</li>
										#end
										<li>
											<input type="text" id="attributes.$id" name="value.$id" class="value" />
											<a href="#" onclick="personaAddAttributeValue(this);return false;">
												<img src="#springUrl('/resources/images/plus.gif')" class="value" />
											</a>
											<a href="#" onclick="personaRemoveAttributeValue(this);return false;">
												<img src="#springUrl('/resources/images/minus.gif')" class="value" />
											</a>
										</li>
									</ul>
								</td>
								<td class="handler">
									<a href="#" onclick="personaAddAttribute(this);return false;">
										<img src="#springUrl('/resources/images/plus.gif')" class="attribute" />
									</a>
									<a href="#" onclick="personaRemoveAttribute(this);return false;">
										<img src="#springUrl('/resources/images/minus.gif')" class="attribute" />
									</a>
								</td>
							</tr>
						</table>
					</div>
				#end
				<div class="attribute">
					<table>
						<tr>
							<td class="label">
								<input type="text" name="alias.0" class="alias" />
								<input type="text" name="type.0" class="type" />
							</td>
							<td class="value">
								<ul>
									<li>
										<input type="text" id="attributes.0" name="value.0" class="value" />
										<a href="#" onclick="personaAddAttributeValue(this);return false;">
											<img src="#springUrl('/resources/images/plus.gif')" class="value" />
										</a>
										<a href="#" onclick="personaRemoveAttributeValue(this);return false;">
											<img src="#springUrl('/resources/images/minus.gif')" class="value" />
										</a>
									</li>
								</ul>
							</td>
							<td class="handler">
								<a href="#" onclick="personaAddAttribute(this);return false;">
									<img src="#springUrl('/resources/images/plus.gif')" class="attribute" />
								</a>
								<a href="#" onclick="personaRemoveAttribute(this);return false;">
									<img src="#springUrl('/resources/images/minus.gif')" class="attribute" />
								</a>
							</td>
						</tr>
					</table>
				</div>
				<table>
					<tr>
						<td class="label">&nbsp;</td>
						<td>
							#if(${persona.id} && ${persona.id} != "")
								<button type="submit">#springMessage("button.modify")</button>
							#else
								<button type="submit">#springMessage("button.add")</button>
							#end
						</td>
					</tr>
				</table>
			</form>
		</fieldset>
	</body>
</html>
